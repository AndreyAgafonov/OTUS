# PAM Пользователи и группы. Авторизация и аутентификация

Задание 1. Запретить всем пользователям, кроме группы admin логин в выходные и праздничные дни
Задание с "*" дать конкретному пользователю права работать с докером и возможность рестартить докер сервис


Поднимется машина с именем PAM.

Задание 1. Запретить всем пользователям, кроме группы admin логин в выходные и праздничные дни
 Задание сделаное с испольтнованием API запроса на сайт https://isdayoff.ru/
 
Создаю виртуальную машину:
- разрешаю авотризацию по ssh:
```
sed -i 's/PasswordAuthentication no/PasswordAuthentication yes/g' /etc/ssh/sshd_config
systemctl restart sshd
```
- Корректирую правило аутентификации для sshd логика работы  - если день недели выходной или праздничный день, то проверяем правли доступа для группы admin иначе пропускаем шаг.
```
sed -i "2i auth       [success=1 default=ignore] pam_exec.so /vagrant/pam_script_auth" /etc/pam.d/sshd
sed -i "3i auth       required     pam_access.so" /etc/pam.d/sshd
```
- Корректирую конфиг для pam_acceess.so Разрешение авторизовываться для группы "admin" остальным - запрещено
```
echo "+:(admin):ALL" >> /etc/security/access.conf
echo "-:ALL:ALL" >> /etc/security/access.conf
```
- Создаю пользователей sveta член группы admin, nastya - нет.
- Отключаю SELinux т.к. не входит в условия задачи и мешает работе текущей.

При попытке авторизации пользотелем через протокол SSH будет запущен скрипт 'pam_script_auth', и произведена проверка согласно условиям задачи. Если Интернет недоступен и cURL завершился с кодом отличным от "0" - сервис недоступен, используем оффлайн инструменты, а именно проверяется день недели и сравниваниется - является ли он выходным, так же ппроверяется яавляется ли текущий день праздником согласно списку holidays (формат dd.mm).

Задание с "*" в процессе.


